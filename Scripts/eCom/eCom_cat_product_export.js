!function(){function e(){let e=`https://${s}/admin/categories/${l}/products.json?limit=${i}`,o=encodeURI(e),a=new XMLHttpRequest;a.open("GET",o,!0),a.onload=function(){a.status>=200&&a.status<400&&(t=JSON.parse(a.responseText),d=t.links.pages,n())},a.send()}function n(){for(r=0;r<d;r+=1){function e(){let e=`https://${s}/admin/categories/${l}/products.json?limit=${i}&page=${r}`;console.log(e);let n=encodeURI(e),a=new XMLHttpRequest;a.open("GET",n,!1),a.onload=function(){a.status>=200&&a.status<400&&(t=JSON.parse(a.responseText),t.data.forEach(e=>{0==e.product.barcode.length?e.EANbarcode="":e.EANbarcode=e.product.barcode,0==e.product.sku.length?e.manufacturersku="":e.manufacturersku=e.product.sku,0==e.product.article_code.length?e.customsku="":e.customsku=e.product.article_code,null==e.product.brand?e.brandname="":e.brandname=e.product.brand.title,e.name="",e.product.i18n.nl?e.name=e.product.i18n.nl.title:e.product.i18n.en&&(e.name=e.product.i18n.en.title),delete e.id,delete e.product,delete e.position,e.delete_to_my_right}),o())},a.send()}e()}}function o(){c+=Papa.unparse(t.data,{header:!0,delimiter:";"}),console.log(c.length+` characters in csv | page: ${r}/${d} | `+r/d*100+"%"),r+1>=d&&(console.log(c),setTimeout(a,4e3))}function a(){var e=new Date,t=new Blob([c]),n=document.createElement("a");n.href=window.URL.createObjectURL(t,{type:"text/plain"}),n.download=e.toString().replace(/ /g,"_")+"_export.csv",n.click()}let c,r,d,s=window.location.host,l=window.location.pathname.match(/\d+/),i=50;if(c="",document.getElementById("Parser"))console.log("Ready");else{let e=document.createElement("script");e.id="Parser",e.setAttribute("src","https://cdn.jsdelivr.net/gh/mholt/PapaParse/papaparse.min.js"),document.head.appendChild(e)}e()}();
